{% schema %}
{
  "name": "Gallery Grid",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "The New-Age Soda Crowd"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Authentic moments from the people who care about taste, vibe, and the ingredients that fuel their world."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "FOLLOW @SOULSURF"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button URL"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Section Background",
      "default": "#FFF6E3"
    },
    {
      "type": "color",
      "id": "text_card_color",
      "label": "Text Card Background",
      "default": "#E2981A",
      "info": "This color will have opacity applied automatically or be used as is."
    },
     {
      "type": "range",
      "id": "text_card_opacity",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Text Card Opacity",
      "default": 17
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#1E1E1E"
    },
    {
      "type": "header",
      "content": "Column 1"
    },
    {
      "type": "textarea",
      "id": "col1_text",
      "label": "Column 1 Text",
      "default": "Feels premium without trying too hard"
    },
    {
      "type": "image_picker",
      "id": "col1_image",
      "label": "Column 1 Image"
    },
    {
      "type": "header",
      "content": "Column 2"
    },
    {
      "type": "image_picker",
      "id": "col2_image",
      "label": "Column 2 Image"
    },
    {
      "type": "textarea",
      "id": "col2_text",
      "label": "Column 2 Text",
      "default": "My fridge staple now."
    },
    {
      "type": "header",
      "content": "Column 3"
    },
    {
      "type": "textarea",
      "id": "col3_text",
      "label": "Column 3 Text",
      "default": "Tastes clean. Looks good. Hits right."
    },
    {
      "type": "image_picker",
      "id": "col3_image",
      "label": "Column 3 Image"
    }
  ],
  "presets": [
    {
      "name": "Gallery Grid"
    }
  ]
}
{% endschema %}

<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap');

  .gallery-grid-section {
    background-color: {{ section.settings.background_color }};
    padding: 80px 0 255px; /* Increased bottom padding */
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: {{ section.settings.text_color }};
    overflow-x: hidden; /* Prevent horizontal scroll */
    width: 100%;
  }

  /* Default: Show header button, hide bottom button */
  .gallery-button-header {
    display: inline-block;
  }
  .gallery-button-wrapper {
    display: none;
  }

  .gallery-container {
    max-width: 1300px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .gallery-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 30px;
    flex-wrap: wrap;
    gap: 20px;
  }
  
  .gallery-header-left {
      max-width: 800px;
  }

  .gallery-heading {
    font-family: 'Playfair Display', serif;
    font-size: 60px;
    font-weight: 600;
    margin: 0 0 20px 0;
    line-height: 1.1;
  }
  
  .gallery-subheading {
      font-size: 16px;
      line-height: 1.5;
      margin: 0;
      color: #333;
  }

  .gallery-button {
    background-color: #000;
    color: #fff;
    padding: 16px 37px;
    border-radius: 50px;
    text-decoration: none;
    font-weight: 600;
    font-size: 17px;
    letter-spacing: 1px;
    display: inline-block;
    transition: background-color 0.3s;
    white-space: nowrap;
    text-transform: uppercase;
    
    /* Animation Properties */
    position: relative;
    overflow: hidden;
    z-index: 10;
    border: 1px solid rgba(208, 151, 0, 0); /* Transparent border of target color */
    outline: none;
  }
  
  .gallery-button span {
     position: relative;
     z-index: 2;
  }

  .gallery-button::after {
    content: '';
    position: absolute;
    bottom: -50%;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #D09700; 
    transform-origin: bottom center;
    transition: transform 1000ms cubic-bezier(0.48, 0, 0.12, 1);
    transform: skewY(9.3deg) scaleY(0);
    z-index: 1;
  }
  
  .gallery-button:hover {
      background-color: transparent;
      border-color: #D09700;
      transform: translateY(-2px);
  }

  .gallery-button:hover::after {
      transform-origin: bottom center;
      transform: skewY(9.3deg) scaleY(2);
  }

  /* Grid Layout */
  .gallery-grid {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 20px;
    margin-top: 50px;
  }

  .gallery-column {
    display: flex;
    flex-direction: column;
    gap: 30px;
  }
  
  /* Cards */
  .gallery-card {
      border-radius: 20px;
      overflow: hidden;
      width: 100%;
  }
  
  .text-card {
      {% assign card_opacity = section.settings.text_card_opacity | divided_by: 100.0 %}
      background-color: {{ section.settings.text_card_color | color_modify: 'alpha', card_opacity }};
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 40px 55px;
      /* min-height removed to allow smaller custom heights */
      height: 100%; /* Fill available space */
  }
  
  .text-card p {
      font-size: 20px;
      font-weight: 500;
      line-height: 1.4;
      margin: 0;
      margin: 0;
      color: {{ section.settings.text_color }};
      font-family: 'Plus Jakarta Sans', sans-serif;
  }
  
  .image-card {
      height: auto;
  }
  
  .image-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border-radius: 20px;
      transition: transform 0.5s ease;
  }

  .image-card:hover img {
      transform: scale(1.05);
  }

  /* Specific Aspect Ratios/Sizes based on visual design */
  
  /* Column 1: Text Top (Small), Image Bottom (Tall) */
  .col-1 .text-card {
      height: 180px; 
  }
  .col-1 .image-card {
      height: 480px; 
  }

  /* Column 2: Image Top (Small/Med), Text Bottom (Small) */
  .col-2 .image-card {
      height: 480px; 
  }
  .col-2 .text-card {
      height: 180px; 
  }
  
   /* Column 3: Text Top (Big), Image Bottom (Med) */
  .col-3 .text-card {
       height: 260px;
  }
  .col-3 .image-card {
       height: 400px;
  }
  
  /* Reset heights to auto for responsive stacking if needed, 
     but keeping fixed proportions helps match the "Grid" look */

  @media screen and (max-width: 1024px) {
    .gallery-heading {
        font-size: 40px;
    }
  }

  @media screen and (max-width: 768px) {
    .gallery-grid-section {
      padding: 60px 0 150px;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 30px;
    }

    /* Two independent columns using subgrid-like approach */
    .gallery-column {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    /* Position columns in grid */
    .col-1 { grid-column: 1; grid-row: 1; }
    .col-2 { grid-column: 2; grid-row: 1; }
    .col-3 { 
      grid-column: 1 / -1; /* Span both columns */
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    /* Col 3 items side by side */
    .col-3 .text-card { grid-column: 1; }
    .col-3 .image-card { grid-column: 2; }
    
    .gallery-heading {
        font-size: 39px;
    }
    
    .gallery-subheading {
        font-size: 14px;
    }
    
    .gallery-header {
        flex-direction: column;
        align-items: flex-start;
        margin-bottom: 20px;
    }

    .gallery-button {
        font-size: 14px;
        padding: 14px 30px;
    }

    .gallery-button-header {
        display: none; /* Hide header button on mobile */
    }

    .gallery-button-wrapper {
        display: block; /* Show bottom button on mobile */
    }

    .gallery-card {
        border-radius: 15px;
    }

    .image-card img {
        border-radius: 15px;
    }

    /* Independent heights for each block - no effect on other blocks */
    .col-1 .text-card { 
      height: 90px !important;
      min-height: unset !important;
    }
    .col-1 .image-card { 
      height: 190px !important;
      min-height: unset !important;
    }
    
    .col-2 .image-card { 
      height: 190px !important;
      min-height: unset !important;
    }
    .col-2 .text-card { 
      height: 90px !important;
      min-height: unset !important;
    }

    .col-3 .text-card { 
      height: 140px !important;
      min-height: unset !important;
    }
    .col-3 .image-card { 
      height: 140px !important;
      min-height: unset !important;
    }

    .image-card img {
        height: 100%;
        aspect-ratio: unset;
    }

    .text-card {
        padding: 20px 15px;
    }

    .text-card p {
        font-size: 15px;
    }
  }

  /* Small mobile devices */
  @media screen and (max-width: 480px) {
    .gallery-grid-section {
      padding: 50px 0 120px;
    }

    .gallery-container {
        padding: 0 12px;
    }

    .gallery-grid {
      gap: 10px;
    }

    .gallery-heading {
        font-size: 32px;
    }

    .gallery-card {
        border-radius: 12px;
    }

    .image-card img {
        border-radius: 12px;
    }

    /* Adjusted heights for smaller screens - each block independent */
    .col-1 .text-card { 
      height: 120px;
    }
    .col-2 .image-card { 
      height: 120px;
    }
    .col-1 .image-card { 
      height: 160px;
    }
    .col-2 .text-card { 
      height: 160px;
    }
    .col-3 .text-card { 
      height: 140px;
    }
    .col-3 .image-card { 
      height: 140px;
    }

    .text-card {
        padding: 15px 12px;
    }

    .text-card p {
        font-size: 13px;
        line-height: 1.3;
    }

    .gallery-button {
        font-size: 12px;
        padding: 12px 25px;
    }
  }
</style>

<style>
  /* Animation Initial States */
  .gallery-card {
    opacity: 0;
    transition: all 0.8s ease-out;
  }

  /* Directional Initial Transforms */
  .col-1 .gallery-card { transform: translateX(-60px); } /* Left from Left */
  
  .col-2 .image-card { transform: translateY(-60px); }   /* Middle Image from Top */
  .col-2 .text-card { transform: translateY(60px); }     /* Middle Text from Bottom */
  
  .col-3 .gallery-card { transform: translateX(60px); }  /* Right from Right */


  /* Triggered State */
  .gallery-grid-section.in-view .gallery-card {
    opacity: 1;
    transform: translate(0, 0);
  }
  
  /* Optional Stagger if needed, but synchronous directional movement often looks cleaner for this style */
</style>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const observerOptions = {
    root: null,
    rootMargin: '0px',
    rootMargin: '0px',
    threshold: 0.5
  };

  const observer = new IntersectionObserver((entries, observer) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('in-view');
        observer.unobserve(entry.target); 
      }
    });
  }, observerOptions);

  const gallerySection = document.querySelector('.gallery-grid-section');
  if (gallerySection) {
    observer.observe(gallerySection);
  }
});
</script>

<div class="gallery-grid-section">
  <div class="gallery-container">
    <div class="gallery-header">
      <div class="gallery-header-left">
        <h2 class="gallery-heading">{{ section.settings.heading }}</h2>
        <p class="gallery-subheading">{{ section.settings.subheading }}</p>
      </div>
      <a href="{{ section.settings.button_url }}" class="gallery-button gallery-button-header"><span>{{ section.settings.button_text }}</span></a>
    </div>

    <div class="gallery-grid">
      <!-- Column 1 -->
      <div class="gallery-column col-1">
        <div class="gallery-card text-card">
          <p>{{ section.settings.col1_text }}</p>
        </div>
        <div class="gallery-card image-card">
          {% if section.settings.col1_image %}
            <img src="{{ section.settings.col1_image | image_url }}" alt="Gallery Image 1" loading="lazy">
          {% else %}
             <img src="{{ 'grdimg1.png' | asset_url }}" alt="Gallery Placeholder" loading="lazy">
          {% endif %}
        </div>
      </div>

      <!-- Column 2 -->
      <div class="gallery-column col-2">
        <div class="gallery-card image-card">
          {% if section.settings.col2_image %}
            <img src="{{ section.settings.col2_image | image_url }}" alt="Gallery Image 2" loading="lazy">
           {% else %}
             <img src="{{ 'grdimg2.png' | asset_url }}" alt="Gallery Placeholder" loading="lazy">
          {% endif %}
        </div>
        <div class="gallery-card text-card">
          <p>{{ section.settings.col2_text }}</p>
        </div>
      </div>

      <!-- Column 3 -->
       
       <!-- Correction: Wrap Col 3 properly to match structure -->
       <div class="gallery-column col-3">
        <div class="gallery-card text-card">
          <p>{{ section.settings.col3_text }}</p>
        </div>
        <div class="gallery-card image-card">
          {% if section.settings.col3_image %}
            <img src="{{ section.settings.col3_image | image_url }}" alt="Gallery Image 3" loading="lazy">
           {% else %}
             <img src="{{ 'grdimg3.png' | asset_url }}" alt="Gallery Placeholder" loading="lazy">
          {% endif %}
        </div>
      </div>
      
    </div>

    <div class="gallery-button-wrapper" style="text-align: center; margin-top: 50px;">
      <a href="{{ section.settings.button_url }}" class="gallery-button"><span>{{ section.settings.button_text }}</span></a>
    </div>
  </div>
</div>
